description: >
  Collects the SHIPYARD_ENVIRONMENT_URL and SHIPYARD_BYPASS_TOKEN for an environment

parameters:
  api-token:
    type: SHIPYARD_API_TOKEN
    description: "API token used to fetch necessary environment variables from Shipyard."

steps:
  - jq/install
  - run:
      name: "Gracefully exit if this is not a PR branch"
      command: "[[ -z $CIRCLE_PULL_REQUEST ]] && circleci-agent task halt || echo This job is for: $CIRCLE_PULL_REQUEST"
  - run:
      name: "Fetch the Shipyard environment variables"
      command: <<include(scripts/get-shipyard-environment.sh)>>
